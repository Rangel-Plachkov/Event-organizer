<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Event Dashboard</title>
    <link rel="stylesheet" href="View/css/event-dashboard.css">
</head>
<body>

<form id="reload-form" action="/event-dashboard" method="POST" style="display: none;">
    <input type="hidden" name="eventId" value="">
</form>

<div class="dashboard">
    <div class="left-panel">
        <h1>Event Details</h1>
        <p><strong>Title:</strong> <?= htmlspecialchars($event->getTitle()) ?></p>
        <p><strong>Date:</strong> <?= htmlspecialchars($event->getEventDate()) ?></p>
        <p><strong>Type:</strong> <?= htmlspecialchars($event->getType()) ?></p>

        <?php if ($event->getHasOrganization()): ?>
            <h2>Organization Details</h2>
            <p><strong>Location:</strong> <?= htmlspecialchars($organization['place_address']) ?></p>
            <p><strong> Info for sending money:</strong> <?= htmlspecialchars($organization['organizer_payment_details']) ?></p>

            <h2>Participants</h2>
            <ul>
                <?php foreach ($participantsIds as $participant): ?>
                    <li>User ID: <?= htmlspecialchars($participant) ?></li>
                <?php endforeach; ?>
            </ul>

            <?php if (!$isParticipant): ?>
                <button id="join-event-btn">Join Event</button>
            <?php endif; ?>

                <!-- Create gift poll -->

                <!-- End create gift poll -->
        <?php else: ?>
            <button id="add-organization-btn">Add Organization</button>

            <div id="organization-form-container" style="display: none;">
                <h2>Add Organization</h2>
                <form id="add-organization-form">
                    <div>
                        <input type="hidden" id="eventId" name="eventId" value=<?= $eventId ?>>
                        <label for="organizer_payment_details">Payment Details:</label>
                        <input type="text" id="organizer_payment_details" name="organizer_payment_details" placeholder="Enter payment details">
                    </div>
                    <div>
                        <label for="place_address">Place Address:</label>
                        <input type="text" id="place_address" name="place_address" placeholder="Enter the place address"></>
                    </div>
                    <div>
                        <label for="is_anonymous">Make Anonymous:</label>
                        <input type="checkbox" id="is_anonymous" name="is_anonymous">
                    </div>
                    <div id="anonymous-users-container" style="display: none;">
                        <label for="excluded_user">Excluded User:</label>
                        <input type="text" id="excluded_user" name="excluded_user" placeholder="Enter username">
                    </div>
                    <button type="submit">Save Organization</button>
                </form>
            </div>

            <div id="organization-feedback"></div>

            
        <?php endif; ?>

    </div>

    <div class="right-panel">
        <h2>Event Comments</h2>
        <div id="comments">
            <?php foreach ($comments as $comment): ?>
                <div class="comment">
                    <p><strong>User <?= htmlspecialchars($comment->getUserId()) ?>:</strong></p>
                    <p><?= htmlspecialchars($comment->getContent()) ?></p>
                </div>
            <?php endforeach; ?>
        </div>
        <?php if ($isParticipant): ?>
            <!-- <form action="/create-comment-op" method="post"> -->
            <form id="comment-form">
                <input type="hidden" id="eventId" name="eventId" value=<?= $eventId ?>>
                <textarea id="new-comment" name="comment" placeholder="Add a comment..." required></textarea>
                <button type="submit">Submit</button>
            </form>
            <div id="comment-feedback"></div>
        <?php endif; ?>

    </div>
</div>

<script src="View/js/event_dashboard_js/event_dashboard.js"></script>
</body>
</html>